<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record model="ir.module.category" id="module_complaint_management_system">
        <field name="name">Complaint Management </field>
        <field
            name="description"
        >Complaint Management system</field>
        <field name="sequence">10</field>
    </record>

    <record id="group_complaintmgmt_viewer" model="res.groups">
        <field name="name">Viewer</field>
        <field name="comment">Module user with general read only access.</field>
        <field name="category_id" ref="module_complaint_management_system" />
    </record>

    <record id="group_complaintmgmt_responsible_person" model="res.groups">
        <field name="name">Responsible User</field>
        <field name="comment">Module user, with responsible person read and write.</field>
        <field name="category_id" ref="module_complaint_management_system" />
        <field
            name="implied_ids"
            eval="[(4,ref('crede_complaint_management.group_complaintmgmt_viewer'))]"
        />
        <field
            name="users"
            eval="[(4, ref('base.user_root')), (4, ref('base.user_admin'))]"
        />
    </record>

    <record id="group_complaintmgmt_assigned_person" model="res.groups">
        <field name="name">Assigned User</field>
        <field
            name="comment"
        >Module user with additional permission for approvals assigned user.</field>
        <field name="category_id" ref="module_complaint_management_system" />
        <field
            name="implied_ids"
            eval="[(4,ref('crede_complaint_management.group_complaintmgmt_viewer'))]"
        />
        <field
            name="users"
            eval="[(4, ref('base.user_root')), (4, ref('base.user_admin'))]"
        />
    </record>

<!--    <record id="group_complaintmgmt_auditor" model="res.groups">-->
<!--        <field name="name">Auditor</field>-->
<!--        <field-->
<!--            name="comment"-->
<!--        >Module user with additional permission specific for the auditor job, such as effectiveness reviews.</field>-->
<!--        <field name="category_id" ref="module_complaint_management_system" />-->
<!--        <field-->
<!--            name="implied_ids"-->
<!--            eval="[(4,ref('crede_complaint_management.group_complaintmgmt_user'))]"-->
<!--        />-->
<!--    </record>-->

    <record id="group_complaintmgmt_Admin_manager" model="res.groups">
        <field name="name">Admin Manager</field>
        <field
            name="comment"
        >Module administrator, able to modify configuration data.</field>
        <field name="category_id" ref="module_complaint_management_system" />
        <field
            name="implied_ids"
            eval="[(4,ref('crede_complaint_management.group_complaintmgmt_viewer'))]"
        />
        <field
            name="implied_ids"
            eval="[(4,ref('crede_complaint_management.group_complaintmgmt_assigned_person'))]"
        />
        <field
            name="implied_ids"
            eval="[(4,ref('crede_complaint_management.group_complaintmgmt_responsible_person'))]"
        />
    </record>


    <!-- rule for responsible user -->
    <record model="ir.rule" id="complaint_user_see_responsible">
        <field name="name">Complaint Responsible Persons</field>
        <field name="model_id" ref="model_crede_complaint" />
        <field name="global" eval="True" />
        <field name="domain_force">['|', '&amp;', ('state','!=','new'),'|',('resp_persons.id','in',[user.id]),('created_by','=',user.id), '&amp;',('state','=','new'),('created_by','=',user.id)]</field>
        <field name="groups" eval="[(4, ref('group_complaintmgmt_responsible_person'))]"/>
        <field name="perm_unlink" eval="1"/>
        <field name="perm_write" eval="1"/>
        <field name="perm_read" eval="1"/>
        <field name="perm_create" eval="1"/>
    </record>

     <!-- rule for assigned user -->
    <record model="ir.rule" id="complaint_user_see_assigned">
        <field name="name">Complaint Assigned Persons</field>
        <field name="model_id" ref="model_crede_complaint" />
        <field name="global" eval="True" />
        <field name="domain_force">['|', '&amp;', ('state','!=','new'),'|',('assigned_person.id','in',[user.id]),('created_by','=',user.id), '&amp;',('state','=','new'),('created_by','=',user.id)]</field>
        <field name="groups" eval="[(4, ref('group_complaintmgmt_assigned_person'))]"/>
        <field name="perm_unlink" eval="1"/>
        <field name="perm_write" eval="1"/>
        <field name="perm_read" eval="1"/>
        <field name="perm_create" eval="1"/>
    </record>

    <record model="ir.rule" id="emp_complaints_comp_rule">
        <field name="name">Emp Complaint multi-company</field>
        <field name="model_id" ref="model_crede_complaint" />
        <field name="global" eval="True" />
        <field name="domain_force">['|',('company_id','=',False),('company_id', 'in', company_ids)]</field>
        <field name="groups" eval="[(4, ref('group_complaintmgmt_Admin_manager'))]"/>
        <field name="perm_unlink" eval="1"/>
        <field name="perm_write" eval="1"/>
        <field name="perm_read" eval="1"/>
        <field name="perm_create" eval="1"/>
    </record>

     <record model="ir.rule" id="all_complaints_view_rule">
        <field name="name">All Complaint view</field>
        <field name="model_id" ref="model_crede_complaint" />
        <field name="global" eval="True" />
        <field name="domain_force">[(1, '=', 1)]</field>
        <field name="groups" eval="[(4, ref('group_complaintmgmt_Admin_manager'))]"/>
        <field name="perm_unlink" eval="1"/>
        <field name="perm_write" eval="1"/>
        <field name="perm_read" eval="1"/>
        <field name="perm_create" eval="1"/>
    </record>
</odoo>
